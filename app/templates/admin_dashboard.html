{% extends 'base.html' %}
{% load clinic_tags %}
{% load static %}

{% block title %}{{ clinic.name }} ‚Äî –ì–ª–∞–≤–≤—Ä–∞—á{% endblock %}

{% block content %}

<!-- –ü–µ—Ä–µ–¥–∞—ë–º –¥–∞–Ω–Ω—ã–µ –≤ JS -->
<script>
    document.body.dataset.currentYear = {{ current_year }};
    document.body.dataset.currentMonth = {{ current_month }};
</script>
{% csrf_token %}
<div class="container-fluid mt-3">
    <div class="row">
        <!-- –ó–∞–ø–∏—Å–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è -->
        <div class="col-md-3 col-section column" data-status="scheduled" id="scheduled-column">
            <div class="column-header">
                <span id="section-title-text">–ó–∞–ø–∏—Å–∏ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è</span>
                <button id="add-btn" class="btn btn-sm btn-success ms-2">+</button>
                <button id="calendar-trigger" class="btn btn-sm btn-outline-secondary ms-1">üìÖ</button>
            </div>
            <small>–í—Å–µ–≥–æ –∑–∞–ø–∏—Å–µ–π: <span id="scheduled-count">0</span></small>
            <div id="scheduled-list"></div>
        </div>

        <!-- –û–∂–∏–¥–∞—é—Ç –ø—Ä–∏–µ–º–∞ -->
        <div class="col-md-3 col-section column" data-status="waiting" id="waiting-column">
            <div class="column-header">
                –û–∂–∏–¥–∞—é—Ç –ø—Ä–∏–µ–º–∞
            </div>
            <small>–í—Å–µ–≥–æ: <span id="waiting-count">0</span></small>
            <div id="waiting-list"></div>
        </div>

        <!-- –ù–∞ –ø—Ä–∏–µ–º–µ -->
        <div class="col-md-3 col-section column" data-status="active" id="active-column">
            <div class="column-header">
                –ù–∞ –ø—Ä–∏–µ–º–µ
            </div>
            <small>–í—Å–µ–≥–æ: <span id="active-count">0</span></small>
            <div id="active-list"></div>
        </div>

        <!-- –ü—Ä–∏–µ–º –∑–∞–≤–µ—Ä—à–∏–ª–∏ -->
        <div class="col-md-3 col-section column" data-status="completed" id="completed-column">
            <div class="column-header">
                –ü—Ä–∏–µ–º –∑–∞–≤–µ—Ä—à–∏–ª–∏
            </div>
            <small>–í—Å–µ–≥–æ: <span id="completed-count">0</span></small>
            <div id="completed-list"></div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è -->
<div class="modal fade" id="calendarModal" tabindex="-1">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–í—ã–±–µ—Ä–∏—Ç–µ –¥–∞—Ç—É</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <div class="d-flex justify-content-between mb-1 small text-muted">
                    <span>–ü–Ω</span><span>–í—Ç</span><span>–°—Ä</span>
                    <span>–ß—Ç</span><span>–ü—Ç</span><span>–°–±</span><span>–í—Å</span>
                </div>
                <div id="cal-days" class="d-flex flex-wrap gap-1"></div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary btn-sm" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                <button type="button" class="btn btn-primary btn-sm" id="apply-calendar">–ü—Ä–∏–º–µ–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>
</div>

<!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –∑–∞–ø–∏—Å–∏ -->
<div class="modal fade" id="addPatientAndAppointmentModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">–î–æ–±–∞–≤–∏—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞ –∏ –∑–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –ø—Ä–∏—ë–º</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
            </div>
            <div class="modal-body">
                <!-- –í–ö–õ–ê–î–ö–ò: –ü–æ–∏—Å–∫ / –°–æ–∑–¥–∞—Ç—å -->
                <ul class="nav nav-tabs mb-3" id="patientTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="search-tab" data-bs-toggle="tab"
                                data-bs-target="#search-pane"
                                type="button" role="tab">–ù–∞–π—Ç–∏ –ø–∞—Ü–∏–µ–Ω—Ç–∞
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="create-tab" data-bs-toggle="tab" data-bs-target="#create-pane"
                                type="button" role="tab">–î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–≥–æ
                        </button>
                    </li>
                </ul>

                <!-- –ö–û–ù–¢–ï–ù–¢ –í–ö–õ–ê–î–û–ö -->
                <div class="tab-content" id="patientTabContent">
                    <!-- –ü–û–ò–°–ö -->
                    <div class="tab-pane fade show active" id="search-pane" role="tabpanel">
                        <div class="mb-3">
                            <label>–§–∞–º–∏–ª–∏—è –ø–∞—Ü–∏–µ–Ω—Ç–∞</label>
                            <input type="text" class="form-control" id="search-patient-input-modal"
                                   placeholder="–í–≤–µ–¥–∏—Ç–µ —Ñ–∞–º–∏–ª–∏—é...">
                            <div id="search-results-modal" class="mt-2"></div>
                            <div id="selected-patient-info" class="mt-2"></div>
                        </div>
                    </div>

                    <!-- –°–û–ó–î–ê–ù–ò–ï -->
                    <div class="tab-pane fade" id="create-pane" role="tabpanel">
                        <form id="create-patient-form-modal-inner">
                            <div class="row">
                                <div class="col-md-6">
                                    <label>–§–∞–º–∏–ª–∏—è</label>
                                    <input type="text" class="form-control" name="last_name" required>
                                </div>
                                <div class="col-md-6">
                                    <label>–ò–º—è</label>
                                    <input type="text" class="form-control" name="first_name" required>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <label>–û—Ç—á–µ—Å—Ç–≤–æ</label>
                                    <input type="text" class="form-control" name="middle_name">
                                </div>
                                <div class="col-md-6">
                                    <label>–¢–µ–ª–µ—Ñ–æ–Ω</label>
                                    <input type="text" class="form-control" name="phone" required>
                                </div>
                            </div>
                            <div class="row mt-2">
                                <div class="col-md-6">
                                    <label>Email</label>
                                    <input type="email" class="form-control" name="email">
                                </div>
                                <div class="col-md-6">
                                    <label>–î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è</label>
                                    <input type="date" class="form-control" name="birth_date">
                                </div>
                            </div>
                        </form>

                        <!-- –ö–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å –ø–∞—Ü–∏–µ–Ω—Ç–∞" -->
                        <div class="mt-3">
                            <button type="button" class="btn btn-primary w-100" id="create-patient-btn">–°–æ–∑–¥–∞—Ç—å
                                –ø–∞—Ü–∏–µ–Ω—Ç–∞
                            </button>
                        </div>

                        <!-- –í—ã–±–æ—Ä –≤—Ä–∞—á–∞ –∏ –≤—Ä–µ–º–µ–Ω–∏ (–ø–æ—è–≤–ª—è–µ—Ç—Å—è –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è) -->
                        <div id="appointment-section" class="d-none mt-3">
                            <hr>
                            <div class="mb-3">
                                <label>–í—Ä–∞—á</label>
                                <select class="form-select" id="doctor-select-modal">
                                    <!-- –ë—É–¥–µ—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                                </select>
                            </div>
                            <div class="mb-3">
                                <label>–î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è</label>
                                <input type="datetime-local" class="form-control" id="datetime-input-modal">
                            </div>
                            <div class="mb-3">
                                <label>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø—Ä–∏—ë–º–∞ (–º–∏–Ω)</label>
                                <select class="form-select" id="duration-select-modal">
                                    <option value="10">10 –º–∏–Ω—É—Ç</option>
                                    <option value="15">15 –º–∏–Ω—É—Ç</option>
                                    <option value="20">20 –º–∏–Ω—É—Ç</option>
                                    <option value="30">30 –º–∏–Ω—É—Ç</option>
                                    <option value="40">40 –º–∏–Ω—É—Ç</option>
                                    <option value="50">50 –º–∏–Ω—É—Ç</option>
                                    <option value="60">60 –º–∏–Ω—É—Ç</option>
                                </select>
                            </div>
                            <button class="btn btn-success w-100" id="create-appointment-btn">–ó–∞–ø–∏—Å–∞—Ç—å –Ω–∞ –ø—Ä–∏—ë–º</button>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>
</div>
<script src="{% static 'js/admin_dashboard.js' %}"></script>
{% endblock %}